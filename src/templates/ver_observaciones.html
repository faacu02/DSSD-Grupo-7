<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Observaciones</title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

	<style>
		.navbar-custom { background: rgba(255,255,255,0.95); backdrop-filter: blur(6px); }
		.card-hero { box-shadow: 0 6px 20px rgba(0,0,0,0.06); }
		.table-observaciones tbody tr:hover { background: rgba(0,0,0,0.02); }
	</style>
</head>

<body class="bg-light">

	<!-- NAVBAR -->
	<nav class="navbar navbar-expand-lg navbar-light navbar-custom">
		<div class="container">
			<a class="navbar-brand fw-bold text-primary" href="{{ url_for('formulario.index') }}">
				<i class="fas fa-project-diagram me-2"></i>ProjectPlanning
			</a>

			<div class="collapse navbar-collapse">
				<ul class="navbar-nav ms-auto">

					<li class="nav-item">
						<a class="nav-link" href="{{ url_for('formulario.formulario_nombre') }}">
							<i class="fas fa-plus-circle me-1"></i>Nuevo Proyecto
						</a>
					</li>

					<li class="nav-item">
						<a class="nav-link text-danger" href="{{ url_for('login.logout') }}">
							<i class="fas fa-sign-out-alt me-1"></i>Cerrar Sesión
						</a>
					</li>

				</ul>
			</div>
		</div>
	</nav>


	<!-- CONTENIDO -->
	<div class="container my-5">
		{% include "messages.html" %}

		<div class="row justify-content-center">
			<div class="col-12 col-lg-10">

				<div class="card card-hero shadow-sm">

					<!-- HEADER -->
					<div class="card-header bg-warning text-dark d-flex justify-content-between align-items-center">
						<h5 class="mb-0">
							<i class="fas fa-eye me-2"></i>
							Observaciones de la etapa: <strong>{{ etapa.nombre }}</strong>
						</h5>

						<a href="{{ url_for('etapa.cargar_etapa', case_id=case_id, proyecto_id=etapa.proyecto_id) }}"
						   class="btn btn-outline-dark btn-sm">
							<i class="fas fa-arrow-left me-1"></i>Volver
						</a>
					</div>

					<!-- BODY -->
					<div class="card-body">

						{% if observaciones and observaciones|length > 0 %}

							<div class="table-responsive">
								<table class="table table-hover table-observaciones align-middle">
									<thead class="table-light">
										<tr>
											<th>Descripción</th>
											<th>Fecha creación</th>
											<th>Fecha límite</th>
											<th>Resuelta</th>
											<th>Acciones</th>
										</tr>
									</thead>

									<tbody>
										{% for ob in observaciones %}
											<tr>
												<td>{{ ob.descripcion }}</td>
												<td>{{ ob.fecha_creacion }}</td>
												<td>{{ ob.fecha_limite }}</td>
												<td>
													{% if ob.resuelta %}
														<span class="badge bg-success">Sí</span>
													{% else %}
														<span class="badge bg-danger">No</span>
													{% endif %}
												</td>
												<td>
													<a href="{{ url_for('observacion.detalle_observacion', 
														observacion_id=ob.id, 
														case_id=case_id, 
														etapa_id=etapa.id, 
														cantidad_observaciones=cantidad_observaciones, 
														proyecto_id=proyecto_id) }}"
													   class="btn btn-sm btn-outline-primary">
														<i class="fas fa-eye me-1"></i>Ver
													</a>
												</td>
											</tr>
										{% endfor %}
									</tbody>
								</table>
							</div>

						{% else %}
							<div class="text-center py-5">
								<i class="fas fa-info-circle fa-2x text-muted"></i>
								<p class="mt-3 text-muted">No hay observaciones registradas para esta etapa.</p>
							</div>
						{% endif %}

					</div>
				</div>

			</div>
		</div>
	</div>


	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
